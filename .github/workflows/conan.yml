name: Conan
on:
  - pull_request
  - push
jobs:
  build-conan:
    strategy:
      matrix:
        os: ['windows-latest', 'ubuntu-latest', 'macos-latest']
        shared: ['False']
    runs-on: '${{ matrix.os }}'
    steps:
      - uses: actions/checkout@v2
      - uses: actions/setup-python@v2
        with:
            python-version: '3.x'
      - name: 'Install conan'
        run: |
            python -m pip install conan
      - name: 'Initialize conan'
        run: |
            conan config init
            conan config set log.print_run_commands=True
      - name: 'Create edyn package + run tests'
        run: |
            conan create . -o edyn:enable_assert=True -o edyn:enable_sanitizer=True -o edyn:build_tests=True -o *:shared=${{ matrix.shared }} -e CONAN_RUN_TESTS=1 -tf None
